<!DOCTYPE html>
<html>

<head>
  <title>Test Image Preview</title>
  <style>
    .container {
      max-width: 600px;
      margin: 50px auto;
      padding: 20px;
    }

    .preview-container {
      margin-top: 20px;
    }

    .preview-img {
      max-width: 300px;
      height: 200px;
      object-fit: cover;
      border: 1px solid #ccc;
    }

    .hidden {
      display: none;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>Test Image Preview</h1>

    <input type="file" id="foto_motor" accept="image/*" onchange="previewImage(event)">

    <div id="imagePreview" class="preview-container hidden">
      <h4>Preview:</h4>
      <img id="previewImg" src="" alt="Preview" class="preview-img">
      <button type="button" onclick="clearImage()">Clear</button>
    </div>
  </div>

  <script>
    function previewImage(event) {
      console.log('previewImage called', event);
      const input = event.target;
      const file = input.files[0];
      console.log('File selected:', file);

      if (file) {
        // Validate file size (2MB = 2097152 bytes)
        if (file.size > 2097152) {
          alert('❌ Ukuran file terlalu besar! Maksimal 2MB.');
          input.value = '';
          return;
        }

        // Validate file type
        const allowedTypes = ['image/jpeg', 'image/jpg', 'image/png'];
        if (!allowedTypes.includes(file.type)) {
          alert('❌ Format file tidak didukung! Gunakan JPG, JPEG, atau PNG.');
          input.value = '';
          return;
        }

        const reader = new FileReader();
        reader.onload = function (e) {
          console.log('FileReader loaded');
          const previewContainer = document.getElementById('imagePreview');
          const previewImg = document.getElementById('previewImg');

          previewImg.src = e.target.result;
          previewContainer.classList.remove('hidden');
          console.log('Preview should be visible now');
        };
        reader.readAsDataURL(file);
      }
    }

    function clearImage() {
      const input = document.getElementById('foto_motor');
      const previewContainer = document.getElementById('imagePreview');
      const previewImg = document.getElementById('previewImg');

      input.value = '';
      previewImg.src = '';
      previewContainer.classList.add('hidden');
    }
  </script>
</body>

</html>